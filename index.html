<html lang="en"><head>
<meta charset="UTF-8">
<link rel="apple-touch-icon" type="image/png" href="https://static.codepen.io/assets/favicon/apple-touch-icon-5ae1a0698dcc2402e9712f7d01ed509a57814f994c660df9f7a952f3060705ee.png">
<meta name="apple-mobile-web-app-title" content="i_bar_map">
<link rel="shortcut icon" type="image/x-icon" href="https://static.codepen.io/assets/favicon/favicon-aec34940fbc1a6e787974dcd360f2c6b63348d4b1f4e06c77743096d55480f33.ico">
<link rel="mask-icon" type="" href="https://static.codepen.io/assets/favicon/logo-pin-8f3771b1072e3c38bd662872f6b673a722f4b3ca2421637d5596661b4e2132cc.svg" color="#111">
<title>i_bar_map</title>
<style>
html,body{
  width: 100%;
  height: 100%;
}
#map { width: 100%;height: 100%; }
.marker-cluster-small {
		background-color: rgba(181, 226, 140, 0.6);
		}
	.marker-cluster-small div {
		background-color: rgba(110, 204, 57, 0.6);
		}

	.marker-cluster-medium {
		background-color: rgba(241, 211, 87, 0.6);
		}
	.marker-cluster-medium div {
		background-color: rgba(240, 194, 12, 0.6);
		}

	.marker-cluster-large {
		background-color: rgba(253, 156, 115, 0.6);
		}
	.marker-cluster-large div {
		background-color: rgba(241, 128, 23, 0.6);
		}

	.marker-cluster {
		background-clip: padding-box;
		border-radius: 20px;
		}
	.marker-cluster div {
		width: 30px;
		height: 30px;
		margin-left: 5px;
		margin-top: 5px;

		text-align: center;
		border-radius: 15px;
		font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
		}
	.marker-cluster span {
		line-height: 30px;
		}
</style>
</head>
<body translate="no">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.4.1/MarkerCluster.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.4.1/MarkerCluster.Default.css">
<div id="map" class="leaflet-container leaflet-fade-anim leaflet-grab leaflet-touch-drag" tabindex="0" style="position: relative;"><div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(0px, 260px, 0px);"><div class="leaflet-pane leaflet-tile-pane"><div class="leaflet-layer " style="z-index: 1; opacity: 1;"><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate3d(0px, 0px, 0px) scale(1);"><img alt="" role="presentation" src="https://c.tile.openstreetmap.org/17/109790/56115.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-84px, 157px, 0px); opacity: 1;"><img alt="" role="presentation" src="https://b.tile.openstreetmap.org/17/109790/56114.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-84px, -99px, 0px); opacity: 1;"><img alt="" role="presentation" src="https://a.tile.openstreetmap.org/17/109790/56116.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-84px, 413px, 0px); opacity: 1;"><img alt="" role="presentation" src="https://a.tile.openstreetmap.org/17/109790/56113.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-84px, -355px, 0px); opacity: 1;"><img alt="" role="presentation" src="https://b.tile.openstreetmap.org/17/109790/56117.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-84px, 669px, 0px); opacity: 1;"></div></div></div><div class="leaflet-pane leaflet-shadow-pane"><img src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png" class="leaflet-marker-shadow leaflet-zoom-animated" alt="" style="margin-left: -43px; margin-top: -86px; width: 41px; height: 41px; transform: translate3d(144px, 725px, 0px);"><img src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png" class="leaflet-marker-shadow leaflet-zoom-animated" alt="" style="margin-left: -43px; margin-top: -86px; width: 41px; height: 41px; transform: translate3d(265px, -149px, 0px);"><img src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png" class="leaflet-marker-shadow leaflet-zoom-animated" alt="" style="margin-left: -43px; margin-top: -86px; width: 41px; height: 41px; transform: translate3d(-28px, 122px, 0px);"><img src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png" class="leaflet-marker-shadow leaflet-zoom-animated" alt="" style="margin-left: -43px; margin-top: -86px; width: 41px; height: 41px; transform: translate3d(-113px, 379px, 0px);"><img src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png" class="leaflet-marker-shadow leaflet-zoom-animated" alt="" style="margin-left: -43px; margin-top: -86px; width: 41px; height: 41px; transform: translate3d(-66px, -329px, 0px);"><img src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png" class="leaflet-marker-shadow leaflet-zoom-animated" alt="" style="margin-left: -43px; margin-top: -86px; width: 41px; height: 41px; transform: translate3d(152px, -319px, 0px);"><img src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png" class="leaflet-marker-shadow leaflet-zoom-animated" alt="" style="margin-left: -43px; margin-top: -86px; width: 41px; height: 41px; transform: translate3d(-36px, -483px, 0px);"><img src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png" class="leaflet-marker-shadow leaflet-zoom-animated" alt="" style="margin-left: -43px; margin-top: -86px; width: 41px; height: 41px; transform: translate3d(214px, 1199px, 0px);"><img src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png" class="leaflet-marker-shadow leaflet-zoom-animated" alt="" style="margin-left: -43px; margin-top: -86px; width: 41px; height: 41px; transform: translate3d(141px, 1594px, 0px);"></div><div class="leaflet-pane leaflet-overlay-pane"><svg pointer-events="none" class="leaflet-zoom-animated" width="160" height="1130" viewBox="-13 -354 160 1130" style="transform: translate3d(-13px, -354px, 0px);"><g></g></svg></div><div class="leaflet-pane leaflet-marker-pane"><img src="https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png" class="leaflet-marker-icon leaflet-zoom-animated leaflet-interactive" alt="" tabindex="0" style="margin-left: -43px; margin-top: -86px; width: 56px; height: 56px; transform: translate3d(144px, 725px, 0px); z-index: 725;"><img src="https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png" class="leaflet-marker-icon leaflet-zoom-animated leaflet-interactive" alt="" tabindex="0" style="margin-left: -43px; margin-top: -86px; width: 56px; height: 56px; transform: translate3d(265px, -149px, 0px); z-index: -149;"><img src="https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png" class="leaflet-marker-icon leaflet-zoom-animated leaflet-interactive" alt="" tabindex="0" style="margin-left: -43px; margin-top: -86px; width: 56px; height: 56px; transform: translate3d(-28px, 122px, 0px); z-index: 122;"><img src="https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png" class="leaflet-marker-icon leaflet-zoom-animated leaflet-interactive" alt="" tabindex="0" style="margin-left: -43px; margin-top: -86px; width: 56px; height: 56px; transform: translate3d(-113px, 379px, 0px); z-index: 379;"><img src="https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png" class="leaflet-marker-icon leaflet-zoom-animated leaflet-interactive" alt="" tabindex="0" style="margin-left: -43px; margin-top: -86px; width: 56px; height: 56px; transform: translate3d(-66px, -329px, 0px); z-index: -329;"><img src="https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png" class="leaflet-marker-icon leaflet-zoom-animated leaflet-interactive" alt="" tabindex="0" style="margin-left: -43px; margin-top: -86px; width: 56px; height: 56px; transform: translate3d(152px, -319px, 0px); z-index: -319;"><img src="https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png" class="leaflet-marker-icon leaflet-zoom-animated leaflet-interactive" alt="" tabindex="0" style="margin-left: -43px; margin-top: -86px; width: 56px; height: 56px; transform: translate3d(-36px, -483px, 0px); z-index: -483;"><img src="https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png" class="leaflet-marker-icon leaflet-zoom-animated leaflet-interactive" alt="" tabindex="0" style="margin-left: -43px; margin-top: -86px; width: 56px; height: 56px; transform: translate3d(214px, 1199px, 0px); z-index: 1199;"><img src="https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png" class="leaflet-marker-icon leaflet-zoom-animated leaflet-interactive" alt="" tabindex="0" style="margin-left: -43px; margin-top: -86px; width: 56px; height: 56px; transform: translate3d(141px, 1594px, 0px); z-index: 1594;"></div><div class="leaflet-pane leaflet-tooltip-pane"></div><div class="leaflet-pane leaflet-popup-pane"></div><div class="leaflet-proxy leaflet-zoom-animated" style="transform: translate3d(2.81064e+07px, 1.43655e+07px, 0px) scale(65536);"></div></div><div class="leaflet-control-container"><div class="leaflet-top leaflet-left"><div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in" href="#" title="Zoom in" role="button" aria-label="Zoom in">+</a><a class="leaflet-control-zoom-out" href="#" title="Zoom out" role="button" aria-label="Zoom out">−</a></div></div><div class="leaflet-top leaflet-right"></div><div class="leaflet-bottom leaflet-left"></div><div class="leaflet-bottom leaflet-right"><div class="leaflet-control-attribution leaflet-control"><a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> | © <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors</div></div></div></div>
<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.4.1/leaflet.markercluster.js"></script>
<script id="rendered-js">
var map = L.map("map", {
  center: [25.040959, 121.553324],
  zoom: 16.5
});

L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
	maxZoom: 19,
	attribution: 
  '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Tiles style by <a href="https://www.hotosm.org/" target="_blank">Humanitarian OpenStreetMap Team</a> hosted by <a href="https://openstreetmap.fr/" target="_blank">OpenStreetMap France</a>'
}).addTo(map);

    var circle = L.circle([25.040959, 121.553324],   // 圓心座標
      500,                // 半徑（公尺）
      {
          color: 'red',      // 線條顏色
          fillColor: '#f03', // 填充顏色
          fillOpacity: 0.1   // 透明度
      }
    ).addTo(map);


var Icon1 = new L.Icon({
  iconUrl: 'https://github.com/Han-lai/i-bar_map/blob/master/alcohol1.png?raw=true',
  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
  iconSize: [55, 56],
  iconAnchor: [43, 86],
  popupAnchor: [1, -86],
  shadowSize: [10, 10]
});

var Icon2 = new L.Icon({
  iconUrl: 'https://github.com/Han-lai/i-bar_map/blob/master/alcohol2.png?raw=true',
  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
  iconSize: [55, 56],
  iconAnchor: [43, 86],
  popupAnchor: [1, -86],
  shadowSize: [10, 10]
});

var Icon3 = new L.Icon({
    iconUrl: 'https://github.com/Han-lai/i-bar_map/blob/master/alcohol3.png?raw=true',
    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
    iconSize: [56, 56],
    iconAnchor: [43, 86],
    popupAnchor: [1, -86],
    shadowSize: [10, 10]
});

var blackIcon = new L.Icon({
    iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-black.png',
    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
    iconSize: [56, 56],
    iconAnchor: [43, 86],
    popupAnchor: [1, -86],
    shadowSize: [10, 10]
});

var imageClass = [" blackIcon", "redIcon", "yellowIcon", "blueIcon"];
var markers = new L.MarkerClusterGroup().addTo(map);;
//在中心座標，放上黑色定位圖標
//L.marker([25.037801, 121.548855], { icon: blackIcon }).addTo(map);


var xhr = new XMLHttpRequest();
xhr.open('get', 'https://raw.githubusercontent.com/Han-lai/i-bar_map/master/taipei_bar.json');
xhr.send();
xhr.onload = function () {
    var data = JSON.parse(xhr.responseText).results;
    for (var i = 0; i < data.length; i++) {

        //將酒吧星級標記不同顏色的圖標
        var imageIcon = blackIcon;
        if (data[i].rating >= 4.5)
            imageIcon = Icon1;
        else if (data[i].rating > 4.0)
            imageIcon = Icon2;
        else if (data[i].rating > 3.0)
            imageIcon = Icon3;

        //設定藥局經緯度和 Popup 內容
        var mark = L.marker([
            data[i].geometry.location.lat,
            data[i].geometry.location.lng
        ], { icon: imageIcon }
        ).bindPopup(
            '<h1 class="popup-name"> [  店名 ]' + 
                data[i].name + '<h1/>' +
            '<p class="popup-star">  [ 星級 ] ' + 
                data[i].rating + '<p/>' +
            '<p class="popup-address">[ 地址 ] ' + 
                data[i].vicinity + '<p/>');
        //將圖標加入圖層
        markers.addLayer(mark);
    }
    map.addLayer(markers);
};
    </script>


</body></html>
